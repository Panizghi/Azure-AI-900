# Module 1 / Computer Vision

# **Introduction**

*Computer vision* is one of the core areas of artificial intelligence (AI), and focuses on creating solutions that enable AI applications to "see" the world and make sense of it.

Of course, computers don't have biological eyes that work the way ours do, but they are capable of processing images; either from a live camera feed or from digital photographs or videos. This ability to process images is the key to creating software that can emulate human visual perception.

Some potential uses for computer vision include:

- **Content Organization**: Identify people or objects in photos and organize them based on that identification. Photo recognition applications like this are commonly used in photo storage and social media applications.
- **Text Extraction**: Analyze images and PDF documents that contain text and extract the text into a structured format.
- **Spatial Analysis**: Identify people or objects, such as cars, in a space and map their movement within that space.

To an AI application, an image is just an array of pixel values. These numeric values can be used as *features* to train machine learning models that make predictions about the image and its contents.

![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/computer-vision-pixels.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/computer-vision-pixels.png)

Training machine learning models from scratch can be very time intensive and require a large amount of data. Microsoft's Computer Vision service gives you access to pre-trained computer vision capabilities.

# **Get started with image analysis on Azure**

The Computer Vision service is a cognitive service in Microsoft Azure that provides pre-built computer vision capabilities. The service can analyze images, and return detailed information about an image and the objects it depicts.

## **Azure resources for Computer Vision**

To use the Computer Vision service, you need to create a resource for it in your Azure subscription. You can use either of the following resource types:

- **Computer Vision**: A specific resource for the Computer Vision service. Use this resource type if you don't intend to use any other cognitive services, or if you want to track utilization and costs for your Computer Vision resource separately.
- **Cognitive Services**: A general cognitive services resource that includes Computer Vision along with many other cognitive services; such as Text Analytics, Translator Text, and others. Use this resource type if you plan to use multiple cognitive services and want to simplify administration and development.

Whichever type of resource you choose to create, it will provide two pieces of information that you will need to use it:

- A **key** that is used to authenticate client applications.
- An **endpoint** that provides the HTTP address at which your resource can be accessed.

**Note**

If you create a Cognitive Services resource, client applications use the same key and endpoint regardless of the specific service they are using.

## **Analyzing images with the Computer Vision service**

After you've created a suitable resource in your subscription, you can submit images to the Computer Vision service to perform a wide range of analytical tasks.

### **Describing an image**

Computer Vision has the ability to analyze an image, evaluate the objects that are detected, and generate a human-readable phrase or sentence that can describe what was detected in the image. Depending on the image contents, the service may return multiple results, or phrases. Each returned phrase will have an associated confidence score, indicating how confident the algorithm is in the supplied description. The highest confidence phrases will be listed first.

To help you understand this concept, consider the following image of the Empire State building in New York. The returned phrases are listed below the image in the order of confidence.

![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/black-white-buildings.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/black-white-buildings.png)

- A black and white photo of a city
- A black and white photo of a large city
- A large white building in a city

### **Tagging visual features**

The image descriptions generated by Computer Vision are based on a set of thousands of recognizable objects, which can be used to suggest *tags* for the image. These tags can be associated with the image as metadata that summarizes attributes of the image; and can be particularly useful if you want to index an image along with a set of key terms that might be used to search for images with specific attributes or contents.

For example, the tags returned for the Empire State building image include:

- skyscraper
- tower
- building

### **Detecting objects**

The object detection capability is similar to tagging, in that the service can identify common objects; but rather than tagging, or providing tags for the recognized objects only, this service can also return what is known as bounding box coordinates. Not only will you get the type of object, but you will also receive a set of coordinates that indicate the top, left, width, and height of the object detected, which you can use to identify the location of the object in the image, like this:

![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/black-white-buildings-objects.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/black-white-buildings-objects.png)

### **Detecting brands**

This feature provides the ability to identify commercial brands. The service has an existing database of thousands of globally recognized logos from commercial brands of products.

When you call the service and pass it an image, it performs a detection task and determine if any of the identified objects in the image are recognized brands. The service compares the brands against its database of popular brands spanning clothing, consumer electronics, and many more categories. If a known brand is detected, the service returns a response that contains the brand name, a confidence score (from 0 to 1 indicating how positive the identification is), and a bounding box (coordinates) for where in the image the detected brand was found.

For example, in the following image, a laptop has a Microsoft logo on its lid, which is identified and located by the Computer Vision service.

![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/laptop.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/laptop.png)

### **Detecting faces**

The Computer Vision service can detect and analyze human faces in an image, including the ability to determine age and a bounding box rectangle for the location of the face(s). The facial analysis capabilities of the Computer Vision service are a subset of those provided by the dedicated [Face Service](https://docs.microsoft.com/en-us/azure/cognitive-services/face/). If you need basic face detection and analysis, combined with general image analysis capabilities, you can use the Computer Vision service; but for more comprehensive facial analysis and facial recognition functionality, use the Face service.

The following example shows an image of a person with their face detected and approximate age estimated.

![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/face.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/face.png)

### **Categorizing an image**

Computer Vision can categorize images based on their contents. The service uses a parent/child hierarchy with a "current" limited set of categories. When analyzing an image, detected objects are compared to the existing categories to determine the best way to provide the categorization. As an example, one of the parent categories is **people_**. This image of a person on a roof is assigned a category of **people_**.

![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/woman-roof.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/woman-roof.png)

A slightly different categorization is returned for the following image, which is assigned to the category **people_group** because there are multiple people in the image:

![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/family-photo.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/family-photo.png)

Review the 86-category list [here](https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision/category-taxonomy).

### **Detecting domain-specific content**

When categorizing an image, the Computer Vision service supports two specialized domain models:

- **Celebrities** - The service includes a model that has been trained to identify thousands of well-known celebrities from the worlds of sports, entertainment, and business.
- **Landmarks** - The service can identify famous landmarks, such as the Taj Mahal and the Statue of Liberty.

For example, when analyzing the following image for landmarks, the Computer Vision service identifies the Eiffel Tower, with a confidence of 99.41%.

![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/landmark.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/landmark.png)

### **Optical character recognition**

The Computer Vision service can use optical character recognition (OCR) capabilities to detect printed and handwritten text in images. This capability is explored in the [Read text with the Computer Vision service](https://docs.microsoft.com/en-us/learn/modules/read-text-computer-vision/) module on Microsoft Learn.

### **Additional capabilities**

In addition to these capabilities, the Computer Vision service can:

- Detect image types - for example, identifying clip art images or line drawings.
- Detect image color schemes - specifically, identifying the dominant foreground, background, and overall colors in an image.
- Generate thumbnails - creating small versions of images.
- Moderate content - detecting images that contain adult content or depict violent, gory scenes.

# LAB TIME

# **Exercise - Analyze images with the Computer Vision service**

The *Computer Vision* cognitive service uses pre-trained machine learning models to analyze images and extract information about them.

For example, suppose the fictitious retailer *Northwind Traders* has decided to implement a "smart store", in which AI services monitor the store to identify customers requiring assistance, and direct employees to help them. By using the Computer Vision service, images taken by cameras throughout the store can be analyzed to provide meaningful descriptions of what they depict.

In this lab, you'll use a simple command-line application to see the Computer Vision service in action. The same principles and functionality apply in real-world solutions, such as web sites or phone apps.

## **Create a *Cognitive Services* resource**

You can use the Computer Vision service by creating either a **Computer Vision** resource or a **Cognitive Services** resource.

If you haven't already done so, create a **Cognitive Services** resource in your Azure subscription.

1. In another browser tab, open the Azure portal at [https://portal.azure.com](https://portal.azure.com/), signing in with your Microsoft account.
2. Click the **＋Create a resource** button, search for *Cognitive Services*, and create a **Cognitive Services** resource with the following settings:
    - **Subscription**: *Your Azure subscription*.
    - **Resource group**: *Select or create a resource group with a unique name*.
    - **Region**: *Choose any available region*:
    - **Name**: *Enter a unique name*.
    - **Pricing tier**: S0
    - **I confirm I have read and understood the notices**: Selected.
3. Review and create the resource, and wait for deployment to complete. Then go to the deployed resource.
4. View the **Keys and Endpoint** page for your Cognitive Services resource. You will need the endpoint and keys to connect from client applications.

## **Run Cloud Shell**

To test the capabilities of the Computer Vision service, we'll use a simple command-line application that runs in the Cloud Shell on Azure.

1. In the Azure portal, select the **[>_]** (*Cloud Shell*) button at the top of the page to the right of the search box. This opens a Cloud Shell pane at the bottom of the portal.
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-portal-guide-1.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-portal-guide-1.png)
    
2. The first time you open the Cloud Shell, you may be prompted to choose the type of shell you want to use (*Bash* or *PowerShell*). Select **PowerShell**. If you do not see this option, skip the step.
3. If you are prompted to create storage for your Cloud Shell, ensure your subscription is specified and select **Create storage**. Then wait a minute or so for the storage to be created.
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-portal-guide-2.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-portal-guide-2.png)
    
4. Make sure the the type of shell indicated on the top left of the Cloud Shell pane is switched to *PowerShell*. If it is *Bash*, switch to *PowerShell* by using the drop-down menu.
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-portal-guide-3.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-portal-guide-3.png)
    
5. Wait for PowerShell to start. You should see the following screen in the Azure portal:
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-prompt.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-prompt.png)
    

## **Configure and run a client application**

Now that you have a Cloud Shell environment, you can run a simple application that uses the Computer Vision service to analyze an image.

1. In the command shell, enter the following command to download the sample application and save it to a folder called ai-900.
    
    Copy
    
    ```
    git clone https://github.com/MicrosoftLearning/AI-900-AIFundamentals ai-900
    
    ```
    
2. The files are downloaded to a folder named **ai-900**. Now we want to see all of the files in your Cloud Shell storage and work with them. Type the following command into the shell:
    
    Copy
    
    ```
    code .
    
    ```
    
    Notice how this opens up an editor like the one in the image below:
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-portal-guide-4.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/powershell-portal-guide-4.png)
    
3. In the **Files** pane on the left, expand **ai-900** and select **analyze-image.ps1**. This file contains some code that uses the Computer Vision service to analyze an image, as shown here:
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/analyze-image-code.png](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/analyze-image-code.png)
    
4. Don't worry too much about the code, the important thing is that it needs the endpoint URL and either of the keys for your Cognitive Services resource. Copy these from the **Keys and Endpoints** page for your resource from the Azure portal and paste them into the code editor, replacing the **YOUR_KEY** and **YOUR_ENDPOINT** placeholder values respectively.
    
    **Tip**
    
    You may need to use the separator bar to adjust the screen area as you work with the **Keys and Endpoint** and **Editor** panes.
    
    After pasting the key and endpoint values, the first two lines of code should look similar to this:
    
    PowerShellCopy
    
    ```
    $key="1a2b3c4d5e6f7g8h9i0j...."
    $endpoint="https..."
    
    ```
    
5. At the top right of the editor pane, use the **...** button to open the menu and select **Save** to save your changes.
    
    The sample client application will use your Computer Vision service to analyze the following image, taken by a camera in the Northwind Traders store:
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/store-camera-1.jpg](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/store-camera-1.jpg)
    
6. In the PowerShell pane, enter the following commands to run the code:
    
    Copy
    
    ```
    cd ai-900
    ./analyze-image.ps1 store-camera-1.jpg
    
    ```
    
7. Review the results of the image analysis, which include:
    - A suggested caption that describes the image.
    - A list of objects identified in the image.
    - A list of "tags" that are relevant to the image.
8. Now let's try another image:
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/store-camera-2.jpg](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/store-camera-2.jpg)
    
    To analyze the second image, enter the following command:
    
    Copy
    
    ```
    ./analyze-image.ps1 store-camera-2.jpg
    
    ```
    
9. Review the results of the image analysis for the second image.
10. Let's try one more:
    
    ![https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/store-camera-3.jpg](https://docs.microsoft.com/en-us/learn/wwl-data-ai/analyze-images-computer-vision/media/store-camera-3.jpg)
    
    To analyze the third image, enter the following command:
    
    Copy
    
    ```
    ./analyze-image.ps1 store-camera-3.jpg
    
    ```
    
11. Review the results of the image analysis for the third image.

# **Summary**

The Computer Vision service provides many capabilities that you can use to analyze images, including generating a descriptive caption, extracting relevant tags, identifying objects, determining image type and metadata, detecting human faces, known brands, and celebrities, and others.

You can find out more about using the Computer Vision service in the [service documentation](https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision).

## **Clean-up**

It's a good idea at the end of a project to identify whether you still need the resources you created. Resources left running can cost you money.

If you are continuing on to other modules in this learning path you can keep your resources for use in other labs.

If you have finished learning, you can delete the resource group or individual resources from your Azure subscription:

1. In the [Azure portal](https://portal.azure.com/), in the **Resource groups** page, open the resource group you specified when creating your resource.
2. Click **Delete resource group**, type the resource group name to confirm you want to delete it, and select **Delete**. You can also choose to delete individual resources by selecting the resource(s), clicking on the three dots to see more options, and clicking **Delete**.